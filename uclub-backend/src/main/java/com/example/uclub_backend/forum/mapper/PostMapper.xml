<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.uclub_backend.forum.mapper.PostMapper">

    <select id="selectByFilters" resultType="com.example.uclub_backend.forum.entity.Post">
        SELECT p.*
        FROM post p
        LEFT JOIN club c ON p.club_id = c.id
        WHERE 1 = 1
        <if test="title != null and title != ''">
            AND p.title LIKE CONCAT('%', #{title}, '%')
        </if>
        <if test="clubName != null and clubName != ''">
            AND c.name LIKE CONCAT('%', #{clubName}, '%')
        </if>
        <if test="startTime != null and startTime != ''">
            AND p.created_at &gt;= #{startTime}
        </if>
        ORDER BY p.created_at DESC
        LIMIT #{offset}, #{limit}
    </select>

    <select id="countByFilters" resultType="int">
        SELECT COUNT(*)
        FROM post p
        LEFT JOIN club c ON p.club_id = c.id
        WHERE 1 = 1
        <if test="title != null and title != ''">
            AND p.title LIKE CONCAT('%', #{title}, '%')
        </if>
        <if test="clubName != null and clubName != ''">
            AND c.name LIKE CONCAT('%', #{clubName}, '%')
        </if>
        <if test="startTime != null and startTime != ''">
            AND p.created_at &gt;= #{startTime}
        </if>
    </select>



</mapper>
